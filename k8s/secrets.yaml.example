# Kubernetes Secrets Template
# ==============================================================================
# HOW TO USE:
# 1. Copy this file: cp secrets.yaml.example secrets.yaml
# 2. Replace all placeholder values with actual base64-encoded secrets
# 3. NEVER commit secrets.yaml to git (already in .gitignore)
#
# To base64 encode a value:
#   echo -n "your_secret_value" | base64
#
# To decode a base64 value:
#   echo "encoded_value" | base64 --decode
# ==============================================================================

apiVersion: v1
kind: Namespace
metadata:
  name: ml-pipeline
---
apiVersion: v1
kind: Secret
metadata:
  name: ml-pipeline-secrets
  namespace: ml-pipeline
type: Opaque
data:
  # Database credentials (base64 encoded)
  # Example: echo -n "your_password" | base64
  DB_PASSWORD: <BASE64_ENCODED_DB_PASSWORD>

  # MinIO/S3 credentials (base64 encoded)
  MINIO_ACCESS_KEY: <BASE64_ENCODED_MINIO_ACCESS_KEY>
  MINIO_SECRET_KEY: <BASE64_ENCODED_MINIO_SECRET_KEY>

  # Redis password (base64 encoded, optional)
  REDIS_PASSWORD: <BASE64_ENCODED_REDIS_PASSWORD>

  # DVC AWS/S3 credentials (base64 encoded)
  DVC_ACCESS_KEY_ID: <BASE64_ENCODED_DVC_ACCESS_KEY>
  DVC_SECRET_ACCESS_KEY: <BASE64_ENCODED_DVC_SECRET_KEY>

  # Sentry DSN for error tracking (base64 encoded, optional)
  MONITORING_SENTRY_DSN: <BASE64_ENCODED_SENTRY_DSN>

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: ml-pipeline-config
  namespace: ml-pipeline
data:
  # Environment
  ENVIRONMENT: "production"
  DEBUG: "false"

  # Database configuration (non-sensitive)
  DB_HOST: "postgres-service"
  DB_PORT: "5432"
  DB_NAME: "crypto_production"
  DB_USER: "ml_pipeline_user"

  # MinIO configuration (non-sensitive)
  MINIO_ENDPOINT: "minio-service:9000"
  MINIO_SECURE: "true"
  MINIO_BUCKET_MODELS: "crypto-models"
  MINIO_BUCKET_FEATURES: "crypto-features"
  MINIO_BUCKET_DATA_VERSIONS: "crypto-data-versions"

  # Redis configuration (non-sensitive)
  REDIS_HOST: "redis-service"
  REDIS_PORT: "6379"
  REDIS_DB: "0"

  # MLflow configuration
  MLFLOW_TRACKING_URI: "http://mlflow-tracking:5000"
  MLFLOW_EXPERIMENT_PREFIX: "crypto_multi_models_prod"
  MLFLOW_ARTIFACT_ROOT: "s3://mlflow-artifacts"

  # DVC configuration
  DVC_REMOTE_NAME: "s3"
  DVC_REMOTE_URL: "s3://ml-pipeline-dvc-prod"
  DVC_ENDPOINT_URL: "http://minio-service:9000"

  # Binance API configuration
  BINANCE_BASE_URL: "https://api.binance.com/api/v3/klines"
  BINANCE_SYMBOLS: "BTCUSDT,ETHUSDT,BNBUSDT,ADAUSDT,SOLUSDT,XRPUSDT,DOTUSDT,AVAXUSDT,MATICUSDT,LINKUSDT"
  BINANCE_INTERVAL: "15m"

  # API Server configuration
  API_HOST: "0.0.0.0"
  API_PORT: "8000"
  API_WORKERS: "8"
  API_RELOAD: "false"
  API_LOG_LEVEL: "info"
  API_CORS_ORIGINS: "https://your-production-domain.com"
  API_RATE_LIMIT: "1000/minute"

  # Monitoring configuration
  MONITORING_PROMETHEUS_PUSHGATEWAY: "prometheus-pushgateway:9091"
  MONITORING_LOG_LEVEL: "INFO"
  MONITORING_ENABLE_METRICS: "true"
  MONITORING_ENABLE_TRACING: "true"

---
# Example deployment using the secrets
# apiVersion: apps/v1
# kind: Deployment
# metadata:
#   name: ml-pipeline-worker
#   namespace: ml-pipeline
# spec:
#   template:
#     spec:
#       containers:
#       - name: worker
#         image: ml-pipeline:latest
#         envFrom:
#         - configMapRef:
#             name: ml-pipeline-config
#         - secretRef:
#             name: ml-pipeline-secrets
